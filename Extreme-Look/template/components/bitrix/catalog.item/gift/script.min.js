!function(t){"use strict";t.JCGiftItem||(t.JCGiftItem=function(t){if(this.productType=0,this.offersView="",this.showAbsent=!0,this.basketAction="ADD",this.showSubscription=!1,this.visual={ID:"",PICT_ID:"",BUY_LINK:"",BASKET_ACTIONS_ID:"",MORE_LINK:"",SUBSCRIBE_LINK:"",QUICK_VIEW_LINK:"",PRICE_ID:"",OLD_PRICE_ID:"",TREE_ID:"",BASKET_PROP_DIV:""},this.product={canBuy:!0,name:"",pict:{},id:0,detailPageUrl:"",addUrl:"",buyUrl:""},this.basketMode="",this.basketData={useProps:!1,emptyProps:!1,quantity:"quantity",props:"prop",basketUrl:"",sku_props:"",sku_props_var:"basket_props",add_url:"",buy_url:""},this.ajaxPath="",this.quickViewData={quickViewParameters:""},this.defaultPict={pict:null},this.canBuy=!0,this.fullDisplayMode=!1,this.viewMode="",this.currentPrices=[],this.currentPriceSelected=0,this.offers=[],this.offerNum=0,this.treeProps=[],this.selectedValues={},this.obProduct=null,this.obPict=null,this.obPrice=null,this.obPriceCurrent=null,this.obPriceOld=null,this.obTree=null,this.obBuyBtn=null,this.obBasketActions=null,this.obMore=null,this.obSubscribe=null,this.obQuickView=null,this.obPopupWin=null,this.basketUrl="",this.basketParams={},this.isTouchDevice=BX.hasClass(document.documentElement,"bx-touch"),this.hoverTimer=null,this.hoverStateChangeForbidden=!1,this.useEnhancedEcommerce=!1,this.dataLayerName="dataLayer",this.brandProperty=!1,this.errorCode=0,"object"==typeof t){switch(this.productType=parseInt(t.PRODUCT_TYPE,10),this.showAbsent=t.SHOW_ABSENT,this.showSubscription=t.USE_SUBSCRIBE,t.ADD_TO_BASKET_ACTION&&(this.basketAction=t.ADD_TO_BASKET_ACTION),this.fullDisplayMode="Y"==t.PRODUCT_DISPLAY_MODE,this.viewMode=t.VIEW_MODE||"",this.useEnhancedEcommerce="Y"==t.USE_ENHANCED_ECOMMERCE,this.dataLayerName=t.DATA_LAYER_NAME,this.brandProperty=t.BRAND_PROPERTY,this.visual=t.VISUAL,this.productType){case 0:case 1:case 2:t.PRODUCT&&"object"==typeof t.PRODUCT?(this.currentPrices=t.PRODUCT.ITEM_PRICES,this.currentPriceSelected=t.PRODUCT.ITEM_PRICE_SELECTED,this.canBuy=t.PRODUCT.CAN_BUY,this.product.name=t.PRODUCT.NAME,this.product.pict=t.PRODUCT.PICT,this.product.id=t.PRODUCT.ID,this.product.detailPageUrl=t.PRODUCT.DETAIL_PAGE_URL,t.PRODUCT.ADD_URL&&(this.product.addUrl=t.PRODUCT.ADD_URL),t.PRODUCT.BUY_URL&&(this.product.buyUrl=t.PRODUCT.BUY_URL),t.BASKET&&"object"==typeof t.BASKET&&(this.basketData.useProps=t.BASKET.ADD_PROPS,this.basketData.emptyProps=t.BASKET.EMPTY_PROPS)):this.errorCode=-1;break;case 3:t.OFFERS_VIEW&&(this.offersView=t.OFFERS_VIEW),t.PRODUCT&&"object"==typeof t.PRODUCT&&(this.product.name=t.PRODUCT.NAME,this.product.id=t.PRODUCT.ID,this.product.detailPageUrl=t.PRODUCT.DETAIL_PAGE_URL),t.OFFERS&&BX.type.isArray(t.OFFERS)&&(this.offers=t.OFFERS,this.offerNum=0,t.OFFER_SELECTED&&(this.offerNum=parseInt(t.OFFER_SELECTED,10)),isNaN(this.offerNum)&&(this.offerNum=0),t.TREE_PROPS&&(this.treeProps=t.TREE_PROPS),t.DEFAULT_PICTURE&&(this.defaultPict.pict=t.DEFAULT_PICTURE.PICTURE));break;default:this.errorCode=-1}t.BASKET&&"object"==typeof t.BASKET&&(t.BASKET.QUANTITY&&(this.basketData.quantity=t.BASKET.QUANTITY),t.BASKET.PROPS&&(this.basketData.props=t.BASKET.PROPS),t.BASKET.BASKET_URL&&(this.basketData.basketUrl=t.BASKET.BASKET_URL),3==this.productType&&t.BASKET.SKU_PROPS&&(this.basketData.sku_props=t.BASKET.SKU_PROPS),t.BASKET.ADD_URL_TEMPLATE&&(this.basketData.add_url=t.BASKET.ADD_URL_TEMPLATE),t.BASKET.BUY_URL_TEMPLATE&&(this.basketData.buy_url=t.BASKET.BUY_URL_TEMPLATE),""==this.basketData.add_url&&""==this.basketData.buy_url&&(this.errorCode=-1024)),t.AJAX_PATH&&(this.ajaxPath=t.AJAX_PATH),t.QUICK_VIEW&&"object"==typeof t.QUICK_VIEW&&t.QUICK_VIEW.QUICK_VIEW_PARAMETERS&&(this.quickViewData.quickViewParameters=t.QUICK_VIEW.QUICK_VIEW_PARAMETERS)}0==this.errorCode&&BX.ready(BX.delegate(this.init,this))},t.JCGiftItem.prototype={init:function(){var t=0,e=null;if(this.obProduct=BX(this.visual.ID),this.obProduct||(this.errorCode=-1),this.obPict=BX(this.visual.PICT_ID),this.obPict||(this.errorCode=-2),this.obPrice=BX(this.visual.PRICE_ID),this.obPriceCurrent=!!this.obPrice&&this.obPrice.querySelector('[data-entity="price-current"]'),this.obPriceOld=BX(this.visual.OLD_PRICE_ID),this.obPriceMeasure=!!this.obPrice&&this.obPrice.querySelector('[data-entity="price-measure"]'),this.obPrice||(this.errorCode=-16),3==this.productType&&this.fullDisplayMode&&this.visual.TREE_ID&&(this.obTree=BX(this.visual.TREE_ID),this.obTree||(this.errorCode=-256)),this.obBasketActions=BX(this.visual.BASKET_ACTIONS_ID),this.obBasketActions&&this.visual.BUY_LINK&&(this.obBuyBtn=BX(this.visual.BUY_LINK)),this.obMore=BX(this.visual.MORE_LINK),this.showSubscription&&(this.obSubscribe=BX(this.visual.SUBSCRIBE_LINK)),0==this.errorCode){switch(this.isTouchDevice||"CARD"==this.viewMode&&(BX.bind(this.obProduct,"mouseenter",BX.proxy(this.hoverOn,this)),BX.bind(this.obProduct,"mouseleave",BX.proxy(this.hoverOff,this))),this.productType){case 0:case 1:case 2:break;case 3:if(this.offers.length>0){if("PROPS"==this.offersView&&(e=BX.findChildren(this.obTree,{tagName:"li"},!0))&&e.length)for(t=0;t<e.length;t++)BX.bind(e[t],"click",BX.delegate(this.selectOfferProp,this));this.setCurrent()}}if(this.obBuyBtn&&("ADD"==this.basketAction?BX.bind(this.obBuyBtn,"click",BX.proxy(this.add2Basket,this)):BX.bind(this.obBuyBtn,"click",BX.proxy(this.buyBasket,this)),this.checkBuyedAdded()),this.obQuickView=BX(this.visual.QUICK_VIEW_LINK),this.obQuickView)BX.bind(this.obQuickView,"click",BX.proxy(this.quickView,this));else if(this.obQuickView=this.obProduct.querySelectorAll('[data-entity="quickView"]'),this.obQuickView)for(var t in this.obQuickView)this.obQuickView.hasOwnProperty(t)&&BX.type.isDomNode(this.obQuickView[t])&&BX.bind(this.obQuickView[t],"click",BX.proxy(this.quickView,this));BX.addCustomEvent(this,"quickViewRequest",BX.proxy(this.quickViewRequest,this))}},checkBuyedAdded:function(){var t={action:"checkComparedDelayedBuyedAdded",checkBuyedAdded:!0};switch(this.productType){case 1:case 2:t.productId=this.product.id;break;case 3:t.offers=this.offers,t.offerNum=this.offerNum}BX.ajax({url:this.ajaxPath,method:"POST",dataType:"json",timeout:60,data:t,onsuccess:BX.delegate(function(t){this.setBuyedAdded(t.buyedAdded),t.buyedAddedIds.length>0&&this.setBuyAddInfo(t.buyedAddedIds)},this)})},setAnalyticsDataLayer:function(e){if(this.useEnhancedEcommerce&&this.dataLayerName){var s,i,r,a,o,n,h={},l={},c=[];switch(this.productType){case 0:case 1:case 2:h={id:this.product.id,name:this.product.name,price:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].PRICE,brand:BX.type.isArray(this.brandProperty)?this.brandProperty.join("/"):this.brandProperty};break;case 3:for(s in this.offers[this.offerNum].TREE)if(this.offers[this.offerNum].TREE.hasOwnProperty(s))for(i in a=s.substring(5),o=this.offers[this.offerNum].TREE[s],this.treeProps)if(this.treeProps.hasOwnProperty(i)&&this.treeProps[i].ID==a)for(r in this.treeProps[i].VALUES)if((n=this.treeProps[i].VALUES[r]).ID==o){c.push(n.NAME);break}h={id:this.offers[this.offerNum].ID,name:this.offers[this.offerNum].NAME,price:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].PRICE,brand:BX.type.isArray(this.brandProperty)?this.brandProperty.join("/"):this.brandProperty,variant:c.join("/")}}switch(e){case"addToCart":(l={event:"addToCart",ecommerce:{currencyCode:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].CURRENCY||"",add:{products:[{name:h.name||"",id:h.id||"",price:h.price||0,brand:h.brand||"",category:h.category||"",variant:h.variant||""}]}}}).ecommerce.add.products[0].quantity=this.currentPrices[this.currentPriceSelected]?this.currentPrices[this.currentPriceSelected].MIN_QUANTITY:""}t[this.dataLayerName]=t[this.dataLayerName]||[],t[this.dataLayerName].push(l)}},hoverOn:function(t){clearTimeout(this.hoverTimer),this.obProduct.style.height=getComputedStyle(this.obProduct).height,BX.addClass(this.obProduct,"hover"),BX.PreventDefault(t)},hoverOff:function(t){this.hoverStateChangeForbidden||(BX.removeClass(this.obProduct,"hover"),this.hoverTimer=setTimeout(BX.delegate(function(){this.obProduct.style.height="auto"},this),300),BX.PreventDefault(t))},quantitySet:function(t){var e=this.offers[t];if(0==this.errorCode){this.canBuy=e.CAN_BUY,this.currentPrices=e.ITEM_PRICES,this.currentPriceSelected=e.ITEM_PRICE_SELECTED;var s=this.currentPrices[this.currentPriceSelected],i=e.PARTNERS_URL;this.canBuy?(s?i?(this.obBuyBtn&&BX.style(this.obBuyBtn,"display","none"),this.obMore&&BX.style(this.obMore,"display","")):(this.obBuyBtn&&BX.adjust(this.obBuyBtn,{props:{disabled:!1},style:{display:""}}),this.obMore&&BX.style(this.obMore,"display","none")):i?(this.obBuyBtn&&BX.style(this.obBuyBtn,"display","none"),this.obMore&&BX.style(this.obMore,"display","")):(this.obBuyBtn&&BX.adjust(this.obBuyBtn,{props:{disabled:!0},style:{display:""}}),this.obMore&&BX.style(this.obMore,"display","none")),this.obSubscribe&&BX.style(this.obSubscribe,"display","none")):this.obSubscribe?"Y"==e.CATALOG_SUBSCRIBE?(BX.style(this.obSubscribe,"display",""),this.obSubscribe.setAttribute("data-item",e.ID),BX(this.visual.SUBSCRIBE_LINK+"_hidden").click(),this.obBuyBtn&&BX.adjust(this.obBuyBtn,{props:{disabled:!0},style:{display:"none"}}),this.obMore&&BX.style(this.obMore,"display","none")):(BX.style(this.obSubscribe,"display","none"),i?(this.obBuyBtn&&BX.style(this.obBuyBtn,"display","none"),this.obMore&&BX.style(this.obMore,"display","")):(this.obBuyBtn&&BX.adjust(this.obBuyBtn,{props:{disabled:!0},style:{display:""}}),this.obMore&&BX.style(this.obMore,"display","none"))):i?(this.obBuyBtn&&BX.style(this.obBuyBtn,"display","none"),this.obMore&&BX.style(this.obMore,"display","")):(this.obBuyBtn&&BX.adjust(this.obBuyBtn,{props:{disabled:!0},style:{display:""}}),this.obMore&&BX.style(this.obMore,"display","none")),this.obPriceMeasure&&(e.MEASURE?BX.adjust(this.obPriceMeasure,{html:"/"+e.MEASURE}):BX.adjust(this.obPriceMeasure,{html:""}))}},selectOfferProp:function(t){var e=0,s=[],i=null,r=null,a="DROPDOWN_LIST"==this.offersView?t:BX.proxy_context;if(a&&a.hasAttribute("data-treevalue")){if(BX.hasClass(a,"selected"))return;if(s=a.getAttribute("data-treevalue").split("_"),this.searchOfferPropIndex(s[0],s[1])){if((r=(i=BX.findParent(a,{attribute:{"data-entity":"sku-line-block"}}))&&BX.findChildren(i,{tagName:"li"},!0))&&0<r.length)for(e=0;e<r.length;e++)r[e].getAttribute("data-onevalue")==s[1]?BX.addClass(r[e],"selected"):BX.removeClass(r[e],"selected");if("DROPDOWN_LIST"==this.offersView){var o=this.obTree.querySelectorAll('[data-entity="sku-line-block"]');for(var n in o)if(o.hasOwnProperty(n)&&BX.type.isDomNode(o[n])){var h=o[n].querySelector(".selected");if(h){var l=o[n].querySelector('[data-entity="current-option"]');l&&(l.innerHTML=h.innerHTML)}}}}}},searchOfferPropIndex:function(t,e){var s,i,r="",a=!1,o=[],n=[],h=-1,l={},c=[];for(s=0;s<this.treeProps.length;s++)if(this.treeProps[s].ID==t){h=s;break}if(-1<h){for(s=0;s<h;s++)l[r="PROP_"+this.treeProps[s].ID]=this.selectedValues[r];if(r="PROP_"+this.treeProps[h].ID,!(a=this.getRowValues(l,r)))return!1;if(!BX.util.in_array(e,a))return!1;for(l[r]=e,s=h+1;s<this.treeProps.length;s++){if(r="PROP_"+this.treeProps[s].ID,!(a=this.getRowValues(l,r)))return!1;if(n=[],this.showAbsent)for(o=[],c=[],c=BX.clone(l,!0),i=0;i<a.length;i++)c[r]=a[i],n[n.length]=a[i],this.getCanBuy(c)&&(o[o.length]=a[i]);else o=a;this.selectedValues[r]&&BX.util.in_array(this.selectedValues[r],o)?l[r]=this.selectedValues[r]:this.showAbsent?l[r]=o.length>0?o[0]:n[0]:l[r]=o[0],this.updateRow(s,l[r],a,o)}this.selectedValues=l,this.changeInfo()}return!0},updateRow:function(t,e,s,i){var r=0,a="",o=!1,n=null,h=this.obTree.querySelectorAll('[data-entity="sku-line-block"]');if(t>-1&&t<h.length)for(n=h[t].querySelectorAll("li"),r=0;r<n.length;r++)(o=(a=n[r].getAttribute("data-onevalue"))==e)?BX.addClass(n[r],"selected"):BX.removeClass(n[r],"selected"),BX.util.in_array(a,i)?BX.removeClass(n[r],"notallowed"):BX.addClass(n[r],"notallowed"),n[r].style.display=BX.util.in_array(a,s)?"":"none",o&&(h[t].style.display=0==a&&1==i.length?"none":"")},getRowValues:function(t,e){var s,i=0,r=[],a=!1,o=!0;if(0==t.length){for(i=0;i<this.offers.length;i++)BX.util.in_array(this.offers[i].TREE[e],r)||(r[r.length]=this.offers[i].TREE[e]);a=!0}else for(i=0;i<this.offers.length;i++){for(s in o=!0,t)if(t[s]!==this.offers[i].TREE[s]){o=!1;break}o&&(BX.util.in_array(this.offers[i].TREE[e],r)||(r[r.length]=this.offers[i].TREE[e]),a=!0)}return!!a&&r},getCanBuy:function(t){var e,s,i=!1,r=!0;for(e=0;e<this.offers.length;e++){for(s in r=!0,t)if(t[s]!==this.offers[e].TREE[s]){r=!1;break}if(r&&this.offers[e].CAN_BUY){i=!0;break}}return i},setCurrent:function(){var t,e=0,s=[],i="",r=!1,a={},o=[],n=this.offers[this.offerNum].TREE;for(t=0;t<this.treeProps.length&&(i="PROP_"+this.treeProps[t].ID,r=this.getRowValues(a,i));t++){if(BX.util.in_array(n[i],r)?a[i]=n[i]:(a[i]=r[0],this.offerNum=0),this.showAbsent)for(s=[],o=[],o=BX.clone(a,!0),e=0;e<r.length;e++)o[i]=r[e],this.getCanBuy(o)&&(s[s.length]=r[e]);else s=r;this.updateRow(t,a[i],r,s)}if(this.selectedValues=a,this.changeInfo(),"DROPDOWN_LIST"==this.offersView){var h=this.obTree.querySelectorAll('[data-entity="sku-line-block"]');for(var l in h)if(h.hasOwnProperty(l)&&BX.type.isDomNode(h[l])){var c=h[l].querySelector(".selected");if(c){var u=h[l].querySelector('[data-entity="current-option"]');u&&(u.innerHTML=c.innerHTML)}}}},changeInfo:function(){var t,e,s=-1,i=!0;for(t=0;t<this.offers.length;t++){for(e in i=!0,this.selectedValues)if(this.selectedValues[e]!==this.offers[t].TREE[e]){i=!1;break}if(i){s=t;break}}s>-1&&(this.obPict&&(this.obPictImg=BX.findChild(this.obPict,{tagName:"IMG"},!0,!1),this.obPictImg&&(this.offers[s].PREVIEW_PICTURE?BX.adjust(this.obPictImg,{props:{src:this.offers[s].PREVIEW_PICTURE.SRC,width:this.offers[s].PREVIEW_PICTURE.WIDTH,height:this.offers[s].PREVIEW_PICTURE.HEIGHT}}):BX.adjust(this.obPictImg,{props:{src:this.defaultPict.pict.SRC,width:this.defaultPict.pict.WIDTH,height:this.defaultPict.pict.HEIGHT}})),this.obPict.style.display=""),this.quantitySet(s),this.setPrice(),this.setBuyedAdded(this.offers[s].BUYED_ADDED),this.offerNum=s)},setPrice:function(){var t=this.currentPrices[this.currentPriceSelected];t?(this.obPriceCurrent&&BX.adjust(this.obPriceCurrent,{html:BX.Currency.currencyFormat(t.PRICE,t.CURRENCY,!0),style:{display:""}}),this.obPriceOld&&BX.adjust(this.obPriceOld,{html:t.BASE_PRICE>0?BX.Currency.currencyFormat(t.BASE_PRICE,t.CURRENCY,!0):"",style:{display:t.BASE_PRICE>0?"":"none"}})):(this.obPriceCurrent&&BX.adjust(this.obPriceCurrent,{html:"",style:{display:"none"}}),this.obPriceOld&&BX.adjust(this.obPriceOld,{html:"",style:{display:"none"}}))},setBuyedAdded:function(t){this.obBuyBtn&&(t?(BX.adjust(this.obBuyBtn,{props:{className:"btn btn-buy-ok",title:BX.message("ADD_BASKET_OK_MESSAGE")},html:'<i class="icon-ok-b"></i>'}),BX.unbindAll(this.obBuyBtn),BX.bind(this.obBuyBtn,"click",BX.delegate(this.basketRedirect,this))):(BX.adjust(this.obBuyBtn,{props:{className:"btn btn-buy",title:BX.message("ADD_BASKET_MESSAGE")},html:'<i class="icon-cart"></i>'}),BX.unbindAll(this.obBuyBtn),BX.bind(this.obBuyBtn,"click",BX.proxy("BUY"==this.basketAction?this.buyBasket:this.add2Basket,this))))},setBuyAddInfo:function(t){if(BX.type.isArray(t))for(var e in this.offers)this.offers.hasOwnProperty(e)&&(this.offers[e].BUYED_ADDED=BX.util.in_array(this.offers[e].ID,t))},quickViewRequest:function(e,s){var i=["/bitrix/components/altop/quick.order.enext/templates/.default/style.min.css"];"quickView"==e?i.push(BX.message("SITE_TEMPLATE_PATH")+"/components/bitrix/catalog.element/article/style.min.css"):(i.push(BX.message("SITE_TEMPLATE_PATH")+"/components/bitrix/catalog.element/.default/style.min.css"),i.push(BX.message("SITE_TEMPLATE_PATH")+"/js/owlCarousel/owl.carousel.min.css"),i.push("/bitrix/components/altop/geo.delivery.enext/templates/slide_panel/style.min.css"),i.push(BX.message("SITE_TEMPLATE_PATH")+"/components/bitrix/sale.location.selector.search/slide_panel/style.min.css"),i.push("/bitrix/components/altop/catalog.set.constructor.enext/templates/.default/style.min.css"),i.push(BX.message("SITE_TEMPLATE_PATH")+"/components/bitrix/sale.products.gift/.default/style.min.css"),i.push(BX.message("SITE_TEMPLATE_PATH")+"/components/bitrix/catalog.store.amount/.default/style.min.css"),i.push(BX.message("SITE_TEMPLATE_PATH")+"/components/bitrix/news.list/articles/style.min.css"),i.push(BX.message("SITE_TEMPLATE_PATH")+"/components/bitrix/news.list/reviews/style.min.css"),i.push("/bitrix/components/altop/add.review.enext/templates/slide_panel/style.min.css"),i.push(BX.message("SITE_TEMPLATE_PATH")+"/components/bitrix/sale.prediction.product.detail/.default/style.min.css"));for(var r=0;r<i.length;r++){var a=i[r];let t=new XMLHttpRequest;t.open("GET",a),t.onreadystatechange=function(){t.readyState===XMLHttpRequest.DONE&&200===t.status&&BX.loadCSS(t.responseURL+"?"+Date.parse(t.getResponseHeader("Last-Modified")))},t.send()}BX.ajax({url:this.ajaxPath,method:"POST",dataType:"json",timeout:60,data:{action:e,productId:this.product.id,parameters:this.quickViewData.quickViewParameters},onsuccess:BX.delegate(function(i){if(i.content&&i.JS?BX.ajax.processScripts(BX.processHTML(i.JS).SCRIPT,!1,BX.delegate(function(){var t=BX.processHTML(i.content);s.innerHTML=t.HTML,BX.ajax.processScripts(t.SCRIPT)},this)):(BX.cleanNode(s),s.appendChild(BX.create("DIV",{props:{className:"alert alert-error alert-show"},html:BX.message("SLIDE_PANEL_UNDEFINED_ERROR")}))),"quickView"==e&&this.popupPanel.appendChild(BX.create("DIV",{props:{className:"popup-panel__footer"},children:[BX.create("A",{attrs:{href:this.product.detailPageUrl,target:"_blank"},props:{className:"btn btn-more"},html:BX.message("BTN_MESSAGE_DETAIL_ITEM")})]})),this.popupPanelShare){var r=document.body.querySelector(".navigation-share");if(r){this.popupPanelShare.innerHTML=r.innerHTML;var a=this.popupPanelShare.querySelectorAll("a");if(a)for(var o in a)a.hasOwnProperty(o)&&BX.type.isDomNode(a[o])&&(a[o].setAttribute("href",a[o].getAttribute("href").replace(encodeURIComponent(t.location.pathname),encodeURIComponent(this.product.detailPageUrl))),a[o].setAttribute("href",a[o].getAttribute("href").replace(encodeURIComponent(document.title),encodeURIComponent(this.product.name))));var n=this.popupPanelShare.querySelector('[data-entity="showShare"]'),h=this.popupPanelShare.querySelector('[data-entity="shareContent"]');n&&h&&(BX.bind(n,"click",function(){BX.isNodeHidden(h)?(BX.style(h,"display","flex"),BX.addClass(n,"active")):(BX.style(h,"display","none"),BX.removeClass(n,"active"))}),BX.bind(document,"click",function(t){BX.isNodeHidden(h)||BX.findParent(t.target,{attr:{"data-entity":"showShare"}},!1)||"showShare"==t.target.getAttribute("data-entity")||BX.findParent(t.target,{attr:{"data-entity":"shareContent"}},!1)||"shareContent"==t.target.getAttribute("data-entity")||(BX.style(h,"display","none"),BX.removeClass(n,"active"),t.stopPropagation())}))}}"quickViewFull"==e&&t.history.pushState("",document.title,this.product.detailPageUrl),$(s).scrollbar()},this)})},quickView:function(e){var s=BX.proxy_context.hasAttribute("data-entity")?"quickViewFull":"quickView";this.popupPanel=BX.create("DIV",{props:{className:"popup-panel"+("quickViewFull"==s?" popup-panel-full":"")+" fadeInBig"}}),this.popupPanelShare=!1,"quickViewFull"==s&&(this.popupPanel.setAttribute("data-location-href",t.location.href),this.popupPanelShare=BX.create("SPAN",{props:{className:"popup-panel__share"}})),this.popupPanel.appendChild(BX.create("DIV",{props:{className:"popup-panel__title-wrap"},children:[BX.create("SPAN",{props:{className:"popup-panel__title"},html:this.product.name}),this.popupPanelShare,BX.create("SPAN",{props:{className:"popup-panel__close"},children:[BX.create("I",{props:{className:"icon-close"}})]})]})),this.popupPanel.appendChild(BX.create("DIV",{props:{className:"popup-panel__content scrollbar-inner"},children:[BX.create("DIV",{props:{className:"popup-panel__loader"},html:"<div><span></span></div>"})]}));var i=this.popupPanel.querySelector(".popup-panel__content");i&&BX.onCustomEvent(this,"quickViewRequest",[s,i]);var r=t.innerWidth-document.body.clientWidth;if(r>0){BX.style(document.body,"padding-right",r+"px");var a=document.querySelector(".page-bg");a&&BX.style(a,"margin-right",r+"px");var o=document.querySelector(".top-panel");if(o){BX.hasClass(o,"fixed")&&BX.style(o,"padding-right",r+"px");var n=o.querySelector(".top-panel__thead");n&&BX.hasClass(n,"fixed")&&BX.style(n,"padding-right",r+"px");var h=o.querySelector(".top-panel__tfoot");h&&BX.hasClass(h,"fixed")&&BX.style(h,"padding-right",r+"px")}var l=document.querySelector(".catalog-section-panel");l&&BX.hasClass(l,"fixed")&&BX.style(l,"padding-right",r+"px")}var c=BX.GetWindowScrollPos().scrollTop;c&&c>0&&BX.style(document.body,"top","-"+c+"px"),BX.addClass(document.body,"popup-panel-active"),document.body.appendChild(this.popupPanel),document.body.appendChild(BX.create("DIV",{props:{className:"modal-backdrop popup-panel__backdrop fadeInBig"}})),"quickViewFull"==s&&e.preventDefault(),e.stopPropagation()},initBasketUrl:function(){switch(this.basketUrl="ADD"==this.basketMode?this.basketData.add_url:this.basketData.buy_url,this.productType){case 1:case 2:this.basketUrl=this.basketUrl.replace("#ID#",this.product.id.toString());break;case 3:this.basketUrl=this.basketUrl.replace("#ID#",this.offers[this.offerNum].ID)}this.basketParams={ajax_basket:"Y"},this.basketParams[this.basketData.quantity]=this.currentPrices[this.currentPriceSelected]?this.currentPrices[this.currentPriceSelected].MIN_QUANTITY:"",this.basketData.sku_props&&(this.basketParams[this.basketData.sku_props_var]=this.basketData.sku_props)},fillBasketProps:function(){if(this.visual.BASKET_PROP_DIV){var t=0,e=null,s=!1,i=null;if((i=BX(this.visual.BASKET_PROP_DIV))&&(e=i.getElementsByTagName("input"))&&e.length)for(t=0;t<e.length;t++)if(!e[t].disabled)switch(e[t].type.toLowerCase()){case"hidden":this.basketParams[e[t].name]=e[t].value,s=!0;break;case"radio":e[t].checked&&(this.basketParams[e[t].name]=e[t].value,s=!0)}s||(this.basketParams[this.basketData.props]=[],this.basketParams[this.basketData.props][0]=0)}},showBasketPropsDropDownPopup:function(t,e){var s=t.querySelector('[data-entity="dropdownContent"]');this.obPopupWin&&this.obPopupWin.close(),this.obPopupWin=BX.PopupWindowManager.create("basketPropsDropDown_"+e+"_"+this.visual.ID,t,{autoHide:!0,offsetLeft:0,offsetTop:3,overlay:!1,draggable:{restrict:!0},closeByEsc:!0,className:"bx-drop-down-popup-window",content:BX.clone(s)}),s.parentNode.appendChild(BX("basketPropsDropDown_"+e+"_"+this.visual.ID)),this.obPopupWin.show()},selectBasketPropsDropDownPopupItem:function(t,e){var s=BX.findParent(t,{className:"product-item-basket-props-drop-down"},!1),i=s.querySelector("INPUT"),r=s.querySelector('[data-entity="current-option"]');i.value=e,r.innerHTML=t.innerHTML,BX.PopupWindowManager.getCurrentPopup().close()},add2Basket:function(t){this.basketMode="ADD",this.basket(),document.body.querySelector(".popup-panel")&&t.stopPropagation()},buyBasket:function(t){this.basketMode="BUY",this.basket(),document.body.querySelector(".popup-panel")&&t.stopPropagation()},sendToBasket:function(){this.canBuy&&(this.initBasketUrl(),this.fillBasketProps(),BX.ajax({method:"POST",dataType:"json",url:this.basketUrl,data:this.basketParams,onsuccess:BX.proxy(this.basketResult,this)}))},basket:function(){this.canBuy&&(this.obBuyBtn.innerHTML='<span class="btn-loader"><span><span></span></span></span>',this.sendToBasket())},basketResult:function(e){if("OK"==e.STATUS)if("BUY"==this.basketMode)this.basketRedirect();else{var s,i,r=this.obProduct.querySelector('[data-entity="image-wrapper"]');switch(this.productType){case 1:case 2:s=this.product.pict.SRC,i=this.product.pict.WIDTH;break;case 3:s=this.offers[this.offerNum].PREVIEW_PICTURE?this.offers[this.offerNum].PREVIEW_PICTURE.SRC:this.defaultPict.pict.SRC,i=this.offers[this.offerNum].PREVIEW_PICTURE?this.offers[this.offerNum].PREVIEW_PICTURE.WIDTH:this.defaultPict.pict.WIDTH}s&&document.body.appendChild(BX.create("IMG",{props:{className:"animated-image"},style:{width:i+"px",position:"absolute","z-index":"1100"},attrs:{src:s}}));var a=document.body.querySelector(".animated-image");if(a){var o=document.querySelector(".top-panel").querySelector(".mini-cart__cart");new BX.easing({duration:500,start:{width:Number(i),left:BX.pos(r).left,top:BX.pos(r).top},finish:{width:70,left:BX.pos(o).left,top:BX.pos(o).top},transition:BX.easing.transitions.linear,step:BX.delegate(function(t){a.style.width=t.width+"px",a.style.left=t.left+"px",a.style.top=t.top+"px"},this),complete:BX.delegate(function(){BX.remove(a),this.setBuyedAdded(!0),this.offers.length>0&&(this.offers[this.offerNum].BUYED_ADDED=!0),BX.onCustomEvent("OnBasketChange"),this.setAnalyticsDataLayer("addToCart");var e=document.body.querySelector(".popup-panel");!e||e&&!BX.hasClass(e,"popup-panel-full")?"/personal/cart/"==t.location.pathname&&setTimeout(function(){t.location.reload(!0)},1e3):e.hasAttribute("data-location-href")&&e.getAttribute("data-location-href").indexOf("/personal/cart/")>-1&&setTimeout(function(){t.location.href=e.getAttribute("data-location-href")},1e3)},this)}).animate()}}else this.setBuyedAdded(!1)},showOfferBasketPropsDropDownPopup:function(t,e){var s=t.querySelector('[data-entity="dropdownContent"]');this.obPopupWin&&this.obPopupWin.close(),this.obPopupWin=BX.PopupWindowManager.create("offerBasketPropsDropDown_"+e+"_"+this.visual.ID,t,{autoHide:!0,offsetLeft:0,offsetTop:3,overlay:!1,draggable:{restrict:!0},closeByEsc:!0,className:"bx-drop-down-popup-window",content:BX.clone(s)}),s.parentNode.appendChild(BX("offerBasketPropsDropDown_"+e+"_"+this.visual.ID)),this.obPopupWin.show()},selectOfferBasketPropsDropDownPopupItem:function(t){BX.PopupWindowManager.getCurrentPopup().close(),this.selectOfferProp(t)},basketRedirect:function(){t.location.href=this.basketData.basketUrl?this.basketData.basketUrl:BX.message("BASKET_URL")}})}(window);