BX.Sale.OrderPaymentChange=function(){var t=function(t){this.ajaxUrl=t.url,this.accountNumber=t.accountNumber||{},this.paymentNumber=t.paymentNumber||{},this.wrapperId=t.wrapperId||"",this.onlyInnerFull=t.onlyInnerFull||"",this.inner=t.inner||"",this.templateFolder=t.templateFolder,this.wrapper=document.getElementById("bx-sopc"+this.wrapperId),this.paySystemsContainer=this.wrapper.getElementsByClassName("sopc-pp")[0],BX.ready(BX.proxy(this.init,this))};return t.prototype.init=function(){var t=this.wrapper.getElementsByClassName("sopc-pp-list")[0];return new BX.easing({duration:500,start:{opacity:0,height:50},finish:{opacity:100,height:"auto"},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(e){t.style.opacity=e.opacity/100,t.style.height=t.height/450+"px"},complete:function(){t.style.height="auto"}}).animate(),BX.bindDelegate(this.paySystemsContainer,"click",{className:"sopc-pp-company"},BX.proxy(function(t){var e=t.target.parentNode,n=e.parentNode.getElementsByClassName("sopc-pp-company-hidden")[0];return"i"!=t.target.tagName&&"I"!=t.target.tagName&&BX.ajax({method:"POST",dataType:"html",url:this.ajaxUrl,data:{sessid:BX.bitrix_sessid(),paySystemId:n.value,accountNumber:this.accountNumber,paymentNumber:this.paymentNumber,inner:this.inner,onlyInnerFull:this.onlyInnerFull},onsuccess:BX.proxy(function(t){if(this.paySystemsContainer.innerHTML=t,1==document.querySelectorAll('div[data-name="'+this.paymentNumber+'"]').length){var n=e.parentNode.parentNode.getElementsByClassName("sopc-pp-company-smalltitle")[0],i=document.querySelectorAll('div[data-name="'+this.paymentNumber+'"]')[0];void 0!==i&&void 0!==n&&(i.innerHTML=n.innerHTML)}},this),onfailure:BX.proxy(function(){return this},this)},this),this},this)),this},t}(),BX.Sale.OrderInnerPayment=function(){var t=function(t){this.ajaxUrl=t.url,this.accountNumber=t.accountNumber||{},this.paymentNumber=t.paymentNumber||{},this.wrapperId=t.wrapperId||"",this.valueLimit=parseFloat(t.valueLimit)||0,this.templateFolder=t.templateFolder,this.wrapper=document.getElementById("bx-sopc"+this.wrapperId),this.inputElement=this.wrapper.getElementsByClassName("inner-payment-form-control")[0],this.sendPayment=this.wrapper.getElementsByClassName("sale-order-inner-payment-button")[0],BX.ready(BX.proxy(this.init,this))};return t.prototype.init=function(){BX.bind(this.inputElement,"input",BX.delegate(function(){this.inputElement.value=this.inputElement.value.replace(/[^\d,.]*/g,"").replace(/,/g,".").replace(/([,.])[,.]+/g,"$1").replace(/^[^\d]*(\d+([.,]\d{0,2})?).*$/g,"$1");var t=parseFloat(this.inputElement.value);t>this.valueLimit&&(this.inputElement.value=this.valueLimit),t<=0?(this.inputElement.value=0,this.sendPayment.classList.add("disabled")):this.sendPayment.classList.remove("disabled")},this)),BX.bind(this.sendPayment,"click",BX.delegate(function(t){return t.target.classList.contains("disabled")?this:(t.target.classList.add("disabled"),BX.ajax({method:"POST",dataType:"html",url:this.ajaxUrl,data:{sessid:BX.bitrix_sessid(),accountNumber:this.accountNumber,paymentNumber:this.paymentNumber,inner:"Y",onlyInnerFull:this.onlyInnerFull,paymentSum:this.inputElement.value},onsuccess:BX.proxy(function(t){t.length>0?this.wrapper.innerHTML=t:window.location.reload()},this),onfailure:BX.proxy(function(){return this},this)},this),this)},this))},t}();