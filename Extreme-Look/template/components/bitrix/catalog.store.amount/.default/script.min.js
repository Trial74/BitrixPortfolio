!function(t){"use strict";t.JCCatalogStore||(t.JCCatalogStore=function(t){this.visual={ID:""},this.item={timezone:"",workingHours:{}},this.obItem=null,this.errorCode=0,"object"==typeof t&&(this.visual=t.VISUAL,this.item.timezone=t.ITEM.TIMEZONE,this.item.workingHours=t.ITEM.WORKING_HOURS,BX.ready(BX.delegate(this.init,this)))},t.JCCatalogStore.prototype={init:function(){this.obItem=BX(this.visual.ID),this.obItem||(this.errorCode=-1),0===this.errorCode&&this.showWorkingHoursToday()},showWorkingHoursToday:function(){var t=this.obItem.querySelector(".catalog-store-amount-item-hours");t&&(t.innerHTML='<div class="catalog-store-amount-item-hours-loader"><div><span></span></div></div>'+BX.message("CSA_LOADING"),BX.removeClass(t,"catalog-store-amount-item-hours-hidden"),BX.ajax({url:BX.message("CSA_TEMPLATE_PATH")+"/ajax.php",method:"POST",dataType:"json",timeout:60,data:{action:"workingHoursToday",siteCharset:BX.message("SITE_CHARSET"),timezone:this.item.timezone,workingHours:this.item.workingHours},onsuccess:BX.delegate(function(o){var s="";if(o.today)for(var i in this.item.workingHoursToday=o.today,this.item.workingHoursToday)this.item.workingHoursToday.hasOwnProperty(i)&&(this.item.workingHoursToday[i].STATUS&&(s+='<span class="catalog-store-amount-item-hours-icon catalog-store-amount-item-hours-icon-'+("OPEN"==this.item.workingHoursToday[i].STATUS?"open":"closed")+'"></span>'),this.item.workingHoursToday[i].WORK_START&&this.item.workingHoursToday[i].WORK_END?this.item.workingHoursToday[i].WORK_START!=this.item.workingHoursToday[i].WORK_END?(s+=this.item.workingHoursToday[i].WORK_START+" - "+this.item.workingHoursToday[i].WORK_END,this.item.workingHoursToday[i].BREAK_START&&this.item.workingHoursToday[i].BREAK_END&&this.item.workingHoursToday[i].BREAK_START!=this.item.workingHoursToday[i].BREAK_END&&(s+='<span class="catalog-store-amount-item-hours-break">',s+=BX.message("CSA_ITEM_BREAK")+" "+this.item.workingHoursToday[i].BREAK_START+" - "+this.item.workingHoursToday[i].BREAK_END,s+="</span>")):s+=BX.message("CSA_ITEM_24_HOURS"):s+=BX.message("CSA_ITEM_OFF"));t.innerHTML=s,0==s.length&&BX.addClass(t,"catalog-store-amount-item-hours-hidden")},this)}))}}),t.JCCatalogStoreSKU||(t.JCCatalogStoreSKU=function(o){for(var s in this.config={id:o.ID,showEmptyStore:o.SHOW_EMPTY_STORE,useMinAmount:o.USE_MIN_AMOUNT,minAmount:o.MIN_AMOUNT},this.messages=o.MESSAGES,this.sku=o.SKU,this.stores=o.STORES,this.obStores={},this.stores)this.obStores[this.stores[s]]=BX(this.config.id+"_"+this.stores[s]);BX.addCustomEvent(t,"onCatalogStoreProductChange",BX.proxy(this.offerOnChange,this))},t.JCCatalogStoreSKU.prototype={offerOnChange:function(t){var o,s=this.sku[t];for(var i in this.obStores){var e=BX.create("I",{props:{className:"icon-"+(s[i]>0?"ok":"close")+"-b catalog-store-amount-item-quantity-icon"}}),a=BX.create("SPAN",{props:{className:"catalog-store-amount-item-quantity-val"},html:s[i]>0?BX.message("CSA_AVAILABLE")+" "+(this.config.useMinAmount?this.getStringCount(s[i]):s[i]):BX.message("CSA_NOT_AVAILABLE")});BX.cleanNode(this.obStores[i]),BX.append(e,this.obStores[i]),BX.append(a,this.obStores[i]),s[i]>0?BX.removeClass(this.obStores[i],"catalog-store-amount-item-quantity-not-avl"):BX.addClass(this.obStores[i],"catalog-store-amount-item-quantity-not-avl"),o=BX.findParent(this.obStores[i],{className:"catalog-store-amount-item"}),this.config.showEmptyStore||s[i]>0?BX.show(o):BX.hide(o)}},getStringCount:function(t){return t>=this.config.minAmount?this.messages.LOT_OF_GOOD:this.messages.NOT_MUCH_GOOD}})}(window);