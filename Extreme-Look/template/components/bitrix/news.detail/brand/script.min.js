!function(){"use strict";window.JCNewsDetailBrands||(window.JCNewsDetailBrands=function(t){this.config={PARAMS:""},this.visual={ID:""},this.item={productsIds:""},this.obItem=null,this.obTabs=null,this.obTabsBlock=null,this.obTabContainers=null,this.obSectionsLinks=null,this.errorCode=0,"object"==typeof t&&(this.config=t.CONFIG,this.visual=t.VISUAL,this.item.productsIds=t.ITEM.PRODUCTS_IDS,BX.ready(BX.delegate(this.init,this)))},window.JCNewsDetailBrands.prototype={init:function(){this.obItem=BX(this.visual.ID),this.obItem||(this.errorCode=-1),0===this.errorCode&&(this.obTabs=this.obItem.querySelector(".brands-detail-tabs-container"),this.obTabsBlock=!!this.obTabs&&this.obTabs.querySelector('[data-entity="tabs"]'),this.obTabContainers=this.obItem.querySelector(".brands-detail-tabs-content"),this.obTabs&&(this.initTabs(),this.obTabsBlock&&(this.tabsPanelFixed=!1,this.tabsPanelScrolled=!1,this.lastScrollTop=0,this.checkTopTabsBlockScroll(),BX.bind(window,"scroll",BX.proxy(this.checkTopTabsBlockScroll,this)),BX.bind(window,"resize",BX.proxy(this.checkTopTabsBlockResize,this)),this.checkActiveTabsBlock(),BX.bind(window,"scroll",BX.proxy(this.checkActiveTabsBlock,this)),BX.bind(window,"resize",BX.proxy(this.checkActiveTabsBlock,this)))),this.obSectionsLinks=this.obItem.querySelector(".brands-detail-sections-links"),this.obSectionsLinks&&this.initSectionsLinks())},initTabs:function(){var t,e=this.obTabs.querySelector(".brands-detail-tabs-list"),s=!!e&&e.querySelectorAll('[data-entity="tab"]');if(e&&(BX.addClass(e,"owl-carousel"),$(e).owlCarousel({autoWidth:!0,nav:!0,navText:['<i class="icon-arrow-left"></i>','<i class="icon-arrow-right"></i>'],navContainer:".brands-detail-tabs-scroll",dots:!1}),s))for(var i in s)s.hasOwnProperty(i)&&BX.type.isDomNode(s[i])&&(t=s[i].getAttribute("data-value"))&&this.obTabContainers.querySelector('[data-value="'+t+'"]')&&BX.bind(s[i],"click",BX.proxy(this.changeTab,this))},checkTopTabsBlockScroll:function(){var t=document.querySelector(".top-panel"),e=0,s=!!t&&t.querySelector(".top-panel__thead"),i=!!t&&t.querySelector(".top-panel__tfoot"),o=BX.pos(this.obTabs).top,a=this.obTabsBlock,n=a.offsetHeight,l=BX.GetWindowScrollPos().scrollTop;if(window.innerWidth<992)if(s&&BX.hasClass(s,"fixed")&&(e=s.offsetHeight,i&&BX.hasClass(i,"visible")&&(e+=i.offsetHeight)),l+e>=o)if(this.tabsPanelFixed)if(!this.tabsPanelScrolled&&e>0&&l<this.lastScrollTop){this.tabsPanelScrolled=!0;var r=this.tabsPanelScrolled;new BX.easing({duration:300,start:{top:Math.abs(parseInt(BX.style(a,"top"),10))},finish:{top:e},transition:BX.easing.transitions.linear,step:function(t){r&&BX.style(a,"top",t.top+"px")}}).animate()}else this.tabsPanelScrolled&&e>0&&l>this.lastScrollTop&&(this.tabsPanelScrolled=!1,new BX.easing({duration:300,start:{top:Math.abs(parseInt(BX.style(a,"top"),10))},finish:{top:e},transition:BX.easing.transitions.linear,step:function(t){BX.style(a,"top",t.top+"px")}}).animate());else this.tabsPanelFixed=!0,BX.style(this.obTabs,"height",n+"px"),BX.style(a,"top",e+"px"),BX.addClass(a,"fixed");else this.tabsPanelFixed&&l+e<o&&(this.tabsPanelFixed=!1,this.tabsPanelScrolled=!1,this.obTabs.removeAttribute("style"),a.removeAttribute("style"),BX.removeClass(a,"fixed"));else t&&BX.hasClass(t,"fixed")&&(e=t.offsetHeight),!this.tabsPanelFixed&&l+e>=o?(this.tabsPanelFixed=!0,BX.style(this.obTabs,"height",n+"px"),BX.style(a,"top",e+"px"),BX.addClass(a,"fixed")):this.tabsPanelFixed&&l+e<o&&(this.tabsPanelFixed=!1,this.obTabs.removeAttribute("style"),a.removeAttribute("style"),BX.removeClass(a,"fixed"));this.lastScrollTop=l},checkTopTabsBlockResize:function(){if(BX.hasClass(this.obTabsBlock,"fixed")){var t=document.querySelector(".top-panel"),e=0,s=!!t&&t.querySelector(".top-panel__thead"),i=!!t&&t.querySelector(".top-panel__tfoot");window.innerWidth<992?s&&BX.hasClass(s,"fixed")&&(e=s.offsetHeight,i&&BX.hasClass(i,"visible")&&(e+=i.offsetHeight)):(t&&BX.hasClass(t,"fixed")&&(e=t.offsetHeight),this.tabsPanelScrolled=!1),BX.style(this.obTabsBlock,"top",e+"px")}},checkActiveTabsBlock:function(){var t=document.querySelector(".top-panel"),e=0,s=!!t&&t.querySelector(".top-panel__thead"),i=!!t&&t.querySelector(".top-panel__tfoot"),o=this.obTabsBlock,a=0,n=this.obTabContainers.querySelectorAll('[data-entity="tab-container"]'),l=this.obTabs.querySelectorAll('[data-entity="tab"]'),r=BX.GetWindowScrollPos().scrollTop;if(n&&l){window.innerWidth<992?s&&BX.hasClass(s,"fixed")&&(e=s.offsetHeight,i&&BX.hasClass(i,"visible")&&(e+=i.offsetHeight)):t&&BX.hasClass(t,"fixed")&&(e=t.offsetHeight),o&&BX.hasClass(o,"fixed")&&(a=o.offsetHeight);var c=r+e+a,h=Object.keys(n).length;if(c>=BX.pos(n[0]).top&&c<=BX.pos(n[h-1]).bottom){for(var d in n)if(n.hasOwnProperty(d)&&BX.type.isDomNode(n[d])){var b=n[d].getAttribute("data-value");if(b&&c>=BX.pos(n[d]).top)for(var p in l)if(l.hasOwnProperty(p)&&BX.type.isDomNode(l[p])){var B=l[p].getAttribute("data-value");B&&(B==b?BX.addClass(l[p],"active"):BX.removeClass(l[p],"active"))}}}else for(var p in l)l.hasOwnProperty(p)&&BX.type.isDomNode(l[p])&&BX.removeClass(l[p],"active")}},changeTab:function(t){BX.PreventDefault(t),BX.unbind(window,"scroll",BX.proxy(this.checkActiveTabsBlock,this));var e,s,i=BX.proxy_context&&BX.proxy_context.getAttribute("data-value");if(i){if(e=this.obTabContainers.querySelectorAll('[data-entity="tab-container"]'))for(var o in e)if(e.hasOwnProperty(o)&&BX.type.isDomNode(e[o])&&e[o].getAttribute("data-value")===i){var a=document.querySelector(".top-panel"),n=0,l=!!a&&a.querySelector(".top-panel__thead"),r=!!a&&a.querySelector(".top-panel__tfoot"),c=BX.pos(e[o]).top,h=BX.GetWindowScrollPos().scrollTop;window.innerWidth<992?l&&(n=l.offsetHeight,h+this.obTabsBlock.offsetHeight+n>c&&r&&(n+=r.offsetHeight)):a&&(n=a.offsetHeight),new BX.easing({duration:500,start:{scroll:h},finish:{scroll:c-this.obTabsBlock.offsetHeight-n},transition:BX.easing.makeEaseOut(BX.easing.transitions.quint),step:BX.delegate(function(t){window.scrollTo(0,t.scroll)},this),complete:BX.delegate(function(){BX.bind(window,"scroll",BX.proxy(this.checkActiveTabsBlock,this))},this)}).animate()}if(s=this.obTabs.querySelectorAll('[data-entity="tab"]'))for(var o in s)s.hasOwnProperty(o)&&BX.type.isDomNode(s[o])&&(s[o].getAttribute("data-value")===i?BX.addClass(s[o],"active"):BX.removeClass(s[o],"active"))}},initSectionsLinks:function(){var t=this.obSectionsLinks.querySelectorAll(".brands-detail-section-link"),e=!1;if(t)for(var s in t)t.hasOwnProperty(s)&&BX.type.isDomNode(t[s])&&(BX.bind(t[s],"click",BX.proxy(this.changeSectionLink,this)),e?BX.removeClass(t[s],"active"):(BX.addClass(t[s],"active"),e=!0))},changeSectionLink:function(t){BX.PreventDefault(t);var e=BX.proxy_context&&BX.proxy_context.getAttribute("data-section-id");if(!BX.hasClass(BX.proxy_context,"active")&&e){var s=this.obItem.querySelector(".brands-detail-products");s&&(s.style.opacity=.2,BX.ajax({url:BX.message("BRAND_TEMPLATE_PATH")+"/ajax.php",method:"POST",dataType:"json",timeout:60,data:{action:"changeSectionLink",siteId:BX.message("SITE_ID"),parameters:this.config.PARAMS,productsIds:this.item.productsIds,sectionId:e},onsuccess:BX.delegate(function(t){t.content&&t.JS&&BX.ajax.processScripts(BX.processHTML(t.JS).SCRIPT,!1,BX.delegate(function(){var e=BX.processHTML(t.content,!1);if(s.innerHTML=e.HTML,t.imgWebp){var i={},o=s.querySelectorAll("img");if(o)for(var a in o)if(o.hasOwnProperty(a)){var n=o[a].getAttribute("data-lazyload-src"),l=o[a].getAttribute("src");n&&"http"!==n.substr(0,4)&&"data:image/"!==n.substr(0,11)&&-1==n.indexOf(".webp")?i[n]=n:l&&"http"!==l.substr(0,4)&&"data:image/"!==l.substr(0,11)&&-1==l.indexOf(".webp")&&(i[l]=l)}Object.keys(i).length>0&&convertImgToWebp(i)}t.imgLazyLoad&&imgLazyLoad(),new BX.easing({duration:2e3,start:{opacity:20},finish:{opacity:100},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(t){s.style.opacity=t.opacity/100},complete:function(){s.removeAttribute("style")}}).animate(),BX.ajax.processScripts(e.SCRIPT)},this))},this)}));var i=this.obSectionsLinks.querySelectorAll(".brands-detail-section-link");if(i)for(var o in i)i.hasOwnProperty(o)&&BX.type.isDomNode(i[o])&&(i[o].getAttribute("data-section-id")===e?BX.addClass(i[o],"active"):BX.removeClass(i[o],"active"))}}})}();