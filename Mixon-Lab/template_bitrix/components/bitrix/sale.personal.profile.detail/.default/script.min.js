BX.namespace("BX.Sale.PersonalProfileComponent"),BX.Sale.PersonalProfileComponent.PersonalProfileDetail={init:function(e){BX.type.isPlainObject(e)&&(this.ajaxUrl=e.ajaxUrl);var t=document.getElementsByClassName("sppd-input-container-property-file");Array.prototype.forEach.call(t,function(e){var t=e.getElementsByClassName("sppd-property-input-delete-file")[0],a=e.getElementsByClassName("sppd-input-file")[0],i=e.getElementsByClassName("sppd-load-file-info")[0],s=e.getElementsByClassName("sppd-load-file-cancel")[0];BX.bindDelegate(e,"click",{class:"sppd-property-check-file"},BX.proxy(function(e){""!=t.value?(idList=t.value.split(";"),-1===idList.indexOf(e.target.value)?t.value=t.value+";"+e.target.value:(idList.splice(idList.indexOf(e.target.value),1),t.value=idList.join(";"))):t.value=e.target.value},this)),BX.bind(a,"change",BX.delegate(function(e){e.target.files.length>1?(i.innerHTML=BX.message("SPPD_FILE_COUNT")+e.target.files.length,s.classList.remove("hidden")):1==e.target.files.length?(fileName=e.target.files[0].name,fileName.length>40?i.innerHTML=fileName.substr(0,9)+"..."+fileName.substr(-9):i.innerHTML=e.target.files[0].name,s.classList.remove("hidden")):(s.classList.add("hidden"),i.innerHTML=BX.message("SPPD_FILE_NOT_SELECTED"))},this)),BX.bind(s,"click",BX.delegate(function(){s.classList.add("hidden"),i.innerHTML=BX.message("SPPD_FILE_NOT_SELECTED"),a.value="",a.files=[]},this))});var a=document.getElementsByClassName("input-add-multiple");for(var i in a){var s=a[i];!BX.type.isDomNode(s)&&BX.type.isNotEmptyString(this.ajaxUrl)||BX.bind(s,"click",BX.delegate(function(e){switch(e.target.getAttribute("data-add-type")){case"LOCATION":this.createLocationInput(e);break;case"TEXT":this.createTextInput(e)}},this))}},createTextInput:function(e){if(BX.type.isDomNode(e.target)){var t=BX.create("input",{style:{marginTop:"6px"},attrs:{className:"form-control",type:"text",name:e.target.getAttribute("data-add-name")}});e.target.parentNode.insertBefore(t,e.target)}},createLocationInput:function(e){var t=parseInt(e.target.getAttribute("data-add-last-key"))+1;BX.ajax({method:"POST",dataType:"html",url:this.ajaxUrl,data:{sessid:BX.bitrix_sessid(),params:{LOCATION_NAME:e.target.getAttribute("data-add-name"),LOCATION_TEMPLATE:e.target.getAttribute("data-add-template"),LOCATION_KEY:t,ACTION:"getLocationHtml"},signedParamsString:this.signedParams},onsuccess:BX.proxy(function(a){var i=BX.create("div",{style:{marginTop:"6px"}});i.innerHTML=a,e.target.parentNode.insertBefore(i,e.target),e.target.setAttribute("data-add-last-key",t)},this),onfailure:BX.proxy(function(){return this},this)},this)}};